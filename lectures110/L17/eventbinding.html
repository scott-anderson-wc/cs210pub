<!DOCTYPE html>
<!-- 
File: bookEx.html
Author: Eni Mustafaraj
Date: 04/05/14
Purpose: Explain the implicit bookmarking example that uses localStorage
and Javascript events to keep track of the last location on a page and return
the user to that position next time it opens the page. 
It is useful for long HTML files (such as Project Gutenberg books).
-->

<html lang="en">
  <head>
    <meta charset="utf-8">        
    <title>CS110: On Event Binding</title>
        
    <!--#include virtual="/~cs110/modularity/bs-head.part" --> 
 </head>
    
  <body>
    <!--#include virtual="/~cs110/modularity/navbar.part" -->
    
    <div class="container">
      <h1>On Event Binding &nbsp;<small>Keeping Javascript and HTML separate</small></h1>
                        <hr>                    
    </div>
    
    <div class="container">
      <div class="row">
            
         <!-- Three columns of the grid are reserved for the sidebar-->
        <div class="col-md-3">
          <div class="bs-sidebar hidden-print" role="complementary">
            <ul class="nav bs-sidenav">
             <li><a href="#review">Review of Events</a></li>
              <li><a href="#binding">Event Binding</a></li>
              <li><a href="#anon">Anonymous Functions</a></li>
            </ul>  
          </div><!-- end of "bs-sidebar"-->
        </div><!--end of "col-md-3" div-->
                                        
                                        
            <div class="col-md-8">      
        <h2 id="review">Review of what we know</h2>
        <p>During the semester we have talked about 
          <a href="../L09/forms1.html#events">events and event attributes</a>, 
          as well as <a href="../L09/jsforms.html#handlers">event handlers</a>.
        In fact, you have already written a few event handlers in lab. </p>
        
        <p>Here is a summary of the terminology we have been using:</p>
        <ul>
          <li><em>event</em> - an action performed by the user or the browser 
            (e.g., user clicks the mouse or browser loads the page)</li>
          <li><em>event attribute</em> - an HTML attribute for elements that are
            the targets of events (e.g. 
          <code>onclick</code> for a button or <code>onload</code> for the body element).</li>
          <li><em>event triggering (or event firing)</em> - a notification that an event has
          occurred.</li>
          <li><em>event handler</em> - some Javascript code (usually a function) that will be 
          executed to handle the response to the event.</li>
          <li><code>this</code> - a special variable that is used within an event handler to
          refer to the <em>target element</em> for the event.</li>
        </ul>
        <br>
        <p>Additionally we have seen two ways in which event handlers can be associated with
        the event attributes:</p>
        
        <ol>
          <li>Inline event handlers: Javascript code directly added to the HTML element.</li>
          <div class="row">
            <div class="col-md-10">
          <pre>
&lt;button <strong>onclick</strong>="alert(<strong>this.innerHTML</strong> + ' was clicked.');"&gt;Winter&lt;/button&gt;
</pre>
           </div>
            
          <div class="col-md-1">
              <br>
              <p><button onclick="alert(this.innerHTML + ' was clicked.');">Winter</button></p>
            </div>
          </div>
          
          <div class="row">
            <div class="col-md-10">
              <pre>
&lt;span <strong>onmouseover</strong>="<strong>this.style.color='blue'</strong>;"&gt;Wellesley College&lt;/span&gt;
</pre>
              </div>
            
          <div class="col-md-2">
              <p><span onmouseover="this.style.color='blue';">Wellesley College</span></p>
            </div>
          </div>
          
        <li>Event handler functions - a function invocation as an attribute value.</li>
    <div class="row">
            <div class="col-md-10">

              <pre>
&lt;script&gt;
<strong>function</strong> greetings(){
    var inputField = document.querySelector("[name='firstName']");
    var name = inputField.value // read value from input 
    alert("Nice to meet you, " + name);
}
&lt;/script&gt;
&lt;p&gt;&lt;input name="firstName"&gt;&lt;/p&gt;
&lt;button <strong>onclick</strong>="greetings();"&gt;Greet me!&lt;/button&gt;
</pre>
              </div>
        <script>
        function greetings(){
    var inputField = document.querySelector("[name='firstName']");
    var name = inputField.value // read value from input 
    alert("Nice to meet you, " + name);
}
        </script>
          <div class="col-md-3">
              <br>
              <p><input name="firstName" size=10></p>
              <button onclick="greetings();">Greet me!</button></p>
            </div>
      </div>                    
        </ol>
        
 <p>The inline event handlers should be used only when there is one or two lines of Javascript code
        to execute and this code is unique to that element.</p>  
  <p>Assigning functions to HTML attributes is a common way to perform event handling and we have
        been using it both in assignments and labs. The problem with this technique is that 
        it doesn't scale well and also it makes hard to develop/maintain the HTML and Javascript files
        separately. Imagine that you have to add a click event attribute to all 
    <a href="../../documentation/js-examples/selected.html">menu items in this page</a>. This makes
        the code ugly and difficult to maintain. Therefore, today we will show another way to do this
        with <em>Javascript event binding</em>.

  <p>You have already seen this, so this section is more of a reminder
  than an introduction.
        
        <h2 id="binding">Event Binding</h2>
        
        <p>Javascript event binding is the process of attaching an event handler to an HTML
        element. This is done in the Javascript file (or within the <code>&lt;script&gt;</code>
        environment), as opposed to the static binding through the HTML attribute. Its advantages are:</p>
        <ul>
          <li>It's good for modularity, since it keeps HTML and Javascript completely separate.</li>
          <li>It allows to unbind event handlers during the application life, or add additional
          event handlers only when needed.</li>
        </ul>
        <br>
        <p>Below are some examples of event binding that are used in some of our applications:</p>
        
        <pre>
// Examples 1-3 are in the Implicit Bookmarking application
window.onload = onDocumentReady; // 1

window.onunload = onLeavingPage; // 2

var aside = document.querySelector("aside"); // 3
aside.onclick = processAsideClick;


/* This code is from the Selected Menu Item application. It shows
how to bind the same event handler to many elements at once.
*/

// select all items to which we want to bind the event handler
var allItems = document.querySelectorAll("nav div"); // is an array

// iterate through these items to perform the binding
for (var i=0; i< allItems.length; i++){
  var item = allItems[i];
  item.onclick = doWhenClicked;
}
</pre>
        <p>The syntax for event binding is the following:</p>
        <blockquote>
        aDOMObject.eventAttribute = functionName;
        </blockquote>
  
        <p><strong>Never use parantheses after the function name in this occasion, since that would be 
          interpreted as function invocation, not event binding.</strong></p>
 
        <p>The function definition for all these function names can be somewhere else in the file,
        either before or after the event binding statements. There is <strong>no explicit function invocation</strong>
          for event handlers (as we do for normal functions). They will be invoked automatically when the event is triggered.</p>
        <p></p>
        
        <h2 id="anon">Anonymous Functions</h2>
        <p>When looking up examples in the web (or your books), you will often come across 
        examples of event binding that look like the one below:</p>
        
        <pre>
window.onload = function() {
  // here some statements;
}
</pre>
<p>Notice that the function keyword in this case is not followed by the function name. 
Such a function is called an <strong>anonymous function</strong>, since there is no way 
for us to refer to it by name somewhere else in the program. This is also a more compact way
to implement event binding, since it is done in one single step. For the moment you can
ignore this syntax, but we will encounter it very soon, when we will discuss the Javascript
library jQuery, which makes heavy use of anonymous functions, especially in the occasions
when a particular kind of funtion is needed, a <em>callback function</em>.</p>

</pre>
      
        <div class="bs-callout bs-callout-danger">
          <h4>Useful Resources</h4>
          <ol>
          <li><a href="http://www.w3schools.com/tags/ref_eventattributes.asp">
            W3Schools list of HTML Event Attributes</a>.</li>
          <li><a href="http://www.w3schools.com/js/js_htmldom_events.asp">
            W3Schools Javascript HTML DOM Events</a>.</li>
          <li><a href="http://www.w3schools.com/js/js_events_examples.asp">
            W3Schools Javascript HTML DOM Event Examples</a>.</li>
            </ol>
        </div>
        
        </div><!--end of "col-md-8"-->
            
</div><!--end of "row"-->

<!--#include virtual="/~cs110/modularity/footer.part" -->
    
</div> <!--end of container>
        
        
<!--#include virtual="/~cs110/modularity/bs-footer.part" -->
</body>

</html>
