<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>

<!-- Copied from http://www.hanewin.net/encrypt/rsa/rsa-test.htm on 2011-11-20 -->

<title>RSA Public Key Encryption Demo</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta content="MSHTML 5.50.4912.300" name="GENERATOR">

<script src="rsa/rsa.js" type="text/javascript"></script>
<script src="rsa/base64.js" type="text/javascript"></script>
<script src="rsa/hex.js" type="text/javascript"></script>
<script src="rsa/keygen.js" type="text/javascript"></script>

<script language="Javascript" type="text/javascript">

function genkey()
{
 var ix = document.t.keylen.selectedIndex;

 var bits=parseInt(document.t.keylen[ix].value);
 if( isNaN(bits) ) {
     alert("invalid number of bits: "+bits);
     return;
  }
  if( bits <= 0 ) {
     alert("number of bits should be a positive integer: "+bits);
     return;
  }

 var startTime=new Date();

 rsaKeys(bits);
 document.t.p.value=rsa_p;
 document.t.q.value=rsa_q;
 document.t.d.value=rsa_d;
 document.t.e.value=rsa_e;
 document.t.u.value=rsa_u;
 document.t.pq.value=rsa_pq;

 var mpi=s2r(b2mpi(rsa_pq)+b2mpi(rsa_e));
 mpi=mpi.replace(/\n/,'');
 document.t.pkey.value=mpi;
 
 var endTime=new Date();
 document.t.howLong.value=(endTime.getTime()-startTime.getTime())/1000.0;
}

function RSAdoEncryption()
{
 var mod=new Array();
 var exp=new Array();
 
 var s = r2s(document.t.pkey.value);
 var l = Math.floor((s.charCodeAt(0)*256 + s.charCodeAt(1)+7)/8);

 mod = mpi2b(s.substr(0,l+2));
 exp = mpi2b(s.substr(l+2));

 var p = document.rsatest.plaintext.value+String.fromCharCode(1);
 var pl = p.length;

 if(pl > l-3)
 {
    alert('In this example plain text length must be less than modulus of '+(l-3)+' bytes');
    return;
 }

 var b=s2b(p);

 var t;
 var i;

 var startTime=new Date();
 var enc=RSAencrypt(b,exp,mod);
 var endTime=new Date();

 document.rsatest.ciphertext.value=s2hex(b2s(enc));
 document.rsatest.howLong.value=(endTime.getTime()-startTime.getTime())/1000.0;
}

function RSAdoDecryption()
{
  var p = rsa_p;
  var q = rsa_q;
  var d = rsa_d;
  var u = rsa_u;
  var enc=s2b(hex2s(document.rsatest.ciphertext.value));

  var startTime=new Date();
  var dec=b2s(RSAdecrypt(enc, d, p, q, u));
  var endTime=new Date();

  document.rsatest.plaintext.value=dec.substr(0, dec.length-1);

  document.rsatest.howLong.value=(endTime.getTime()-startTime.getTime())/1000.0;
}

</script>
</head><body bgcolor="#ffcccc">
<h2 align="center">RSA Secret Form</h2> 
<center><font size="-1">2011 Scott D. Anderson, adapted from 2005 Herbert Hanewinkel, adapted from John Hanna's RSA implementation</font></center>
<hr>
<center>[<a href="http://www.hanewin.net/encrypt/rsa/rsa.htm">Description</a>] [Test]</center>
<p>
</p><form name="t">
<table>
<tbody>
<tr><td>No of RSA key bits:</td><td>
<select name="keylen">
<option>256</option>
<option selected=true>512</option>
<option>768</option>
<option>1024</option>
<option>2048</option>
</select>
<input onclick="genkey()" value="GenerateKey" type="button">
</td></tr>

<tr><td colspan="2">RSA operates with huge integers. They are displayed here as arrays
of 28 Bit integers as used by the implementation.<br>
Key generation in Javascript takes time (depending on your processor's speed it could be minutes),
please be patient.</td></tr>
<tr><td>prime factor p:</td><td><input size="120" name="p" readonly="readonly"></td></tr>
<tr><td>prime factor q:</td><td><input size="120" name="q" readonly="readonly"></td></tr>
<tr><td></td></tr>
<tr><td>Public exponent (e):</td><td><input size="10" name="e" readonly="readonly"></td></tr>
<tr><td>Public Modulo (p*q):</td><td><input size="120" name="pq" readonly="readonly"></td></tr>
<tr><td>Private exponent (d):</td><td><input size="120" name="d" readonly="readonly"></td></tr>
<tr><td>Private inverse  (u):</td><td><input size="120" name="u" readonly="readonly"></td></tr>
<tr><td>&nbsp;</td></tr>
<tr><td>OpenPGP Multi Precision Integer<br>(MPI) of Public Key (base64):</td>
<td><input size="120" name="pkey" readonly="readonly"></td></tr>
<tr><td></td>
<td align="right">This took <input size="6" name="howLong"> seconds</td></tr>
</tbody></table>
</form>
<p></p>
<hr>
<form name="rsatest">
<table><tbody><tr><td>Plaintext:</td>
<td colspan="2"><input size="120" name="plaintext" type="text"></td>
</tr>

<tr>
<td>Ciphertext in hex:</td>
<td colspan="2"><input size="120" name="ciphertext" type="text"></td>
</tr>

<tr>
<td>&nbsp;</td>
<td>
<input value="Encrypt" onclick="RSAdoEncryption()" type="button"> &nbsp; &nbsp; 
<input value="Decrypt" onclick="RSAdoDecryption()" type="button"> &nbsp; &nbsp; 
</td><td align="right">This took <input size="4" name="howLong"> seconds</td>
</tr>
</tbody></table>
</form>

<hr width="99%" align="center">
<table width="100%"><tbody><tr>
<td>
<font size="-1"><i>www.hanewin.de</i></font>
</td>
<td align="right"><font size="-1"><i>
<a href="http://www.hanewin.de/homee.htm" target="_top">Home</a>
</i></font></td>
</tr></tbody></table>

</body></html>
