<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Class Activities</title>
    <!--#include virtual="../../modularity/bs-head.part" -->
    <link rel="stylesheet" type="text/css" href="http://cs.wellesley.edu/~cs307/js/google-code-prettify/prettify-sda.css">
  <script src="http://google-code-prettify.googlecode.com/svn/loader/prettify.js"></script>
    <style>
      #TOC_list {list-style-type: none;}

      .groceries .num { font-size: larger; font-weight: bold; }
      .groceries .good { font-size: larger; font-style: italic; }

    </style>
    
  </head>
  <body>
    <!--#include virtual="../../modularity/navbar.part" -->

    <div class="container">
      <h1>jQuery</h1>
      <hr>
    </div>
      
    <div class="container">
      <div class="row">
     
        <div class="col-md-3">
          <div class="bs-sidebar hidden-print" role="complementary">
            <ul class="nav bs-sidenav">  
              <div id="insert_TOC_here"></div>
            </ul>
          </div>
        </div>

        <div class="col-md-8">
          
<h2>Goal</h2>

<p>By the end of today, you will be able to:
  <ol>
    <li>understand the jQuery wrapper function, <code>$()</code></li>
    <li>use the jQuery wrapper for selecting or creating elements</li>
    <li>add event handlers with jQuery syntax</li> 
    <li>convert Javascript code to jQuery code</li>
  </ol>
  
 <div class="alert alert-warning">
          
 <h4>Test Page</h4> 
   <p>This is <a href="testpage.html" target="_blank">an empty HTML page</a> that has a link to the jQuery 
     library. We will use
   the page to test some of the jQuery statements in the quiz questions.</p>
</div>         

 <h2>Why jQuery over JavaScript?</h2>
 <ol>
   <li><p>It's more concise.
     
   <li><p>It handles browser inconsistencies and incompatibilities, so jQuery
   code is more likely to run correctly in all browsers.
     
   <li><p>It does cool things like those animations that we have for removing
   quiz answers (list items). You can try it on the items in this list. We'll
     explain that code on Thursday. But here is a 
     <a href="../L20/jqueryEffects-ex.html" target="_blank">list of some other cool things</a>
     that we'll also learn on Thursday.
 </ol>
<!--
<p>Here's the code for those animations. It's shockingly short.
  
<pre class="prettyprint lang-js linenums">
function hideAnswer() {
    // hide a PRE or a P inside the LI (this). Don't hide the
    // whole LI, or the numbering changes.
    $("pre,p",this)
         .css('border-color','red')
         .css('background-color','#FF8080')
         .fadeOut(1000);
}

$("li").click(hideAnswer);
</pre>

<p>Let's take a minute to make we understand that code, including the use
  of <code>this</code>, the use of <em>chaining</em>, and even the
  animation method, <code>.fadeOut()</code>.

<p>The code could have been even <em>more</em> concise by using an
  anonymous function instead of naming it <code>hideAnswer</code> and then
  binding it.
-->

<h2>Recap</h2>

<p>In the readings, the most important points we want you to understand
  are:
  <ul>
    <li>jQuery is a popular JavaScript library that makes code that is
    more concise, consistent and portable.
      
    <li>To use jQuery, you have to load the library. There are many ways;
    we're going to load it from Google.

    <li>Almost everything in jQuery works by selecting a set of elements
    and then operating on them using methods. 
      <pre class="prettyprint lang-js">$("set selector").meth1();</pre>

    <li>When operating on sets of existing things, that <q>set
    selector</q> is the same as the CSS language:
      <pre class="prettyprint lang-js">$("nav > a").css("text-decoration","none");</pre>

    <li>jQuery can also create elements by putting HTML code in the
    selector string:

      <pre class="prettyprint lang-js">$("&lt;p&gt;").text("Search")</pre>

    <li>Those methods can be <q>chained</q> so you can do several things
    with the set of elements. For example, to add a linke to the nav
    element, we can do this:

      <pre class="prettyprint lang-js">$("&lt;a&gt;").text("Search").attr("href","http://www.google.com/").appendTo("nav");</pre>

    <li>We also looked at a technique called <em>cloning</em>; more on
    that later.

    <li>Finally, we looked
    a <a href="L18.html#hide_show_anon_handler">hiding, showing and
    anonymous functions as event handlers</a>

  </ul>

  <h2>Quiz Question Nr. 1</h2>
  <p>Assume you have an HTML page with a lot of text, for example the lecture notes.
          What will the statement <code>$("p")</code> do?</p>   
  <ol type="A">
    <li><p>Return the first <code>p</code> element that it finds.</li>
    <li><p>Return an array of all <code>p</code> elements in the document.</li>
    <li><p>Create a new paragraph, unattached to the document.
    <li><p>Create a new paragraph at the end of the body.
  </ol> 
          
    <h2>Quiz Question Nr. 2</h2> 
<p>Which of the following statements will add a new header element to the page?</p>
          
<pre class="prettyprint lang-js">
 // Case 1
 $("h2").text("November").appendTo("body");
 
 // Case 2
 $("&lt;h2&gt;").text("November").appendTo("body");
</pre>
          
  <ol type="A">
    <li><p>Case 1</li>
    <li><p>Case 2</li>
  </ol>
          
<h2>Quiz Question Nr. 3</h2> 
<p>In Javascript, inside the body of an event handler, we often write code such as:
          <code>this.innerHTML</code> or <code>this.src</code> to access an attribute
          of the element that was <strong>the target</strong> of the event.</p>
<p>What is the corresponding way to do the same in jQuery?</p>
<ol type="A">
 <li><pre class="prettyprint lang-js"> $("this").attr("src"); </pre></li>         
   <li><pre class="prettyprint lang-js"> $(this).attr("src"); </pre></li>  
   <li><pre class="prettyprint lang-js"> $("this").src; </pre></li>         
   <li><pre class="prettyprint lang-js"> $(this).src; </pre></li>
</ol>          

 <h2>Quiz Question Nr. 4</h2>         
<p>Which of the following code excerpts will make an <code>h1</code>
  element disappear when it is clicked on?</p>
<ol type="A">
<li><pre class="prettyprint lang-js">$("h1").onclick="display=none"; </pre></li>           
<li><pre class="prettyprint lang-js">$("h1").click=function(){this.style.display="none"}; </pre></li> 
<li><pre class="prettyprint lang-js">$("h1").click(function(){$(this).css("display", "none")}); </pre></li>  
<li><pre class="prettyprint lang-js">$("h1").onclick(function(){$(this).css("display", "none")}); </pre></li> 
</ol>          
          
<p>What's another way to make it disappear?

<h2>Quiz Question Nr. 5</h2> 
 <p>Given the following code, how can we output each person's name on the console?</p>         

<pre class="prettyprint lang-js">
var students = [{name: "Harry", age: 17}, {name: "Ginny", age: 16}, {name: "Hagrid", age: 69}];
for (var i=0; i < students.length; i++ ) {
     // your code here
}
</pre>

<ol type="A">
<li><pre class="prettyprint lang-js">console.log(students.name);</pre></li>
<li><pre class="prettyprint lang-js">console.log(students[i].name);</pre></li>
<li><pre class="prettyprint lang-js">var stud = students[i]; console.log(stud.name);</pre></li>
<li><pre class="prettyprint lang-js">var stud = students[i]; console.log(stud[i].name);</pre></li>
</ol>         

<h2>Image Gallery</h2> 

<p>You might remember a while ago the example of Animals image gallery (you also revisited
it in Lab with cartoon characters). </p>  

<p>Here is the <a href="animalsjquery/animals.html" target="_blank">solved Animals image gallery with Javascript</a>.</p>

<p>We'll take some time to review that code.  

<p>Some of the functions we wrote had several lines of code. One of the
things that jQuery can do is to allow us write less code.  Let's do that
now.</p>


<div class="alert alert-info">
<h4>jsFiddle Code</h4>  
  <p>Here is the <a href="http://jsfiddle.net/pbj1g5fb/" target="_blank">jsFiddle</a> for the Animals example 
    (with less data). Let's use it
  to write our jQuery code. Notice that we have selected "jQuery 1.11.0" in the dropdown menu
  for Frameworks & Extensions.</p>
</div>  
<h2>Task 1: Add images with jQuery</h2> 
          
  <p>Here is the Javascript code we wrote to populate the <code>#thumbnails</code> element
          with all animal images.</p>       
  <pre class="prettyprint lang-js">
var div = document.querySelector("#thumbnails")
for (var i=0; i&lt;images.length; i++){  
  var info = images[i];
  var img = document.createElement("img");
  img.setAttribute("src", info.src);
  img.setAttribute("alt", info.alt);
  img.setAttribute("class", info.class);
  div.appendChild(img);
}
</pre> 

<p>Can you replace these seven lines of Javascript code with a few lines of jQuery? Use the jsFiddle to 
try it out. Hint: You don't need variables such as div or img and you can chain jQuery methods.</p>

<h2>Task 2: Add event handler for click event</h2> 
<p>To add the event handler for the clicking of images, we did two things in Javascript: </p>
<pre class="prettyprint lang-js">
// Bind function name to event
img.onclick = showImage;

// Function definition
function showImage(){
  document.querySelector("#animal img").setAttribute("src", this.src);
  document.querySelector("#animal img").setAttribute("alt", this.alt);
  document.querySelector("#animal figcaption").innerHTML = this.alt;
}
</pre>

<p>How can we replace these lines with jQuery using
  the <code>click()</code>, <code>attr()</code> and <code>html()</code>
  methods?

<p>Also, don't forget the correct syntax for event handlers (Quiz Nr. 4).</p>

<h2>Task 2b</h2>

<p>We were able to set all the attributes of the <q>big</q> image from
attributes of the thumbnail, but suppose that wasn't possible. Suppose
that the thumbnail image looks terrible when expanded, and we need a
higher-resolution image.  If that info is in the object, we have two
strategies:
  <ul>
    <li>Copy the extra attribute(s) to the thumbnail in a custom
    attribute, say <code>data-highres-src</code>.  Then copy that to
    the <code>#animal img</code> when the thumbnail is clicked.
      
    <li>Copy the index of the info object to the thumbnail in a custom
    attribute, say <code>data-index</code>. Then use that to look up the
    info object when the thumbnail is clicked.
  </ul>

<p>Implement either of these in the jsfiddle.

<h2>Cloning</h2>

<p>We also looked at a technique called <em>cloning</em>.  Cloning allows
  you to build more-complex structures by writing them in HTML and cloning
  them, rather than writing the HTML indirectly via JavaScript/jQuery.

<p>The best way to motivate this would be to write some very complicated
  HTML and show how cloning makes it easier than the alternatives.  But
  for the short time we have in class, that doesn't seem like a good
  strategy. So, I'll write some moderately complicated HTML; please trust
  me on the rest.

<p>We'll built a grocery list that will look like this:
  
<ol class="groceries" id="list1">
  <li><p>Buy <span class="num">1</span> <span class="good">gallon of milk</span> !!</p></li>
  <li><p>Buy <span class="num">2</span> <span class="good">loaves of bread</span> !!</p></li>
  <li><p>Buy <span class="num">1</span> <span class="good">apple</span> !!</p></li>
</ol>

<p>Nothing too complex, but each list item is moderately complicated:

<pre class="prettyprint lang-html">
&lt;ol class="groceries" id="list1"&gt;
  &lt;li&gt;&lt;p&gt;Buy &lt;span class="num"&gt;1&lt;/span&gt; &lt;span class="good"&gt;gallon of milk&lt;/span&gt; !!&lt;/p&gt;&lt;/li&gt;
  &lt;li&gt;&lt;p&gt;Buy &lt;span class="num"&gt;2&lt;/span&gt; &lt;span class="good"&gt;loaves of bread&lt;/span&gt; !!&lt;/p&gt;&lt;/li&gt;
  &lt;li&gt;&lt;p&gt;Buy &lt;span class="num"&gt;1&lt;/span&gt; &lt;span class="good"&gt;apple&lt;/span&gt; !!&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
</pre>

<p>You could do this in JS/JQ, but it would be tedious and
error-prone. Instead, let's use cloning.  We'll set up our template like
this:

<ol class="groceries" id="list2">
  <li><p>Buy <span class="num">N</span> <span class="good">SOMETHING</span> !!</p></li>
</ol>

<pre class="prettyprint lang-html">
&lt;ol class="groceries" id="list2"&gt;
  &lt;li&gt;&lt;p&gt;Buy &lt;span class="num"&gt;N&lt;/span&gt; &lt;span class="good"&gt;SOMETHING&lt;/span&gt; !!&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
</pre>

<p>Now, let's make our real list. Notice that it starts out empty.

<pre class="prettyprint lang-html">
&lt;ol class="groceries" id="real_list"&gt;
&lt;/ol&gt;
</pre>

<p>Now, just to make it easier to add items, we'll create a form:
  

<pre class="prettyprint lang-html">
&lt;form&gt;
  &lt;p&gt;how many: &lt;input id="n" type="number"&gt;
  &lt;p&gt;of what: &lt;input id="what" type="text"&gt;
    &lt;button type="button" id="add_item"&gt;Add Item&lt;/button&gt;
&lt;/form&gt;
</pre>

<p>And some JS/JQ code that does the cloning. Notice that the code can
focus on just putting the correct data into the clone, rather than on the
HTML structuring.  The <code>.find()</code> method looks through the clone
(a tree of nodes) to find elements matching the selector (just like jQuery
itself).  We can then set their text and anything else we want.

<pre class="prettyprint lang-js linenums">
$("#add_item").click(function () {
    var clone = $("#list2 > li").clone();
    clone.find(".num").text( $("#n").val() );
    clone.find(".good").text( $("#what").val() );
    clone.appendTo("#real_list");
});
</pre>  

<p>Here it is in action:

<ol class="groceries" id="real_list">
</ol>

<form>
  <p>how many: <input id="n" type="number">
  <p>of what: <input id="what" type="text">
    <button type="button" id="add_item">Add Item</button>
</form>
  

<h2>Task 3: Which radio button is clicked?</h2>
<p>Using the event handler method <code>.change()</code>, the selector <code>:checked</code>
and the method <code>val()</code> alert which radio button was clicked.</p>

<h2>Challenge</h2>
          <p>Study the code for
the <a href="animalsjquery/animals-final.js" target="_blank">Javascript
solution</a> to understand what happens when a radio button is
checked. Given that the jQuery methods <code>.show()</code>
and <code>.hide()</code> can switch the property "display" between
"initial" and "none", can you write the jQuery code (within
the <code>.change()</code> event handler to perform the same behavior?</p>

<h2>Summary</h2>
<p>We hope that after these activities you have a good understanding of:
  <ul>

    <li>the jQuery wrapper function, <code>$()</code>
    <li>how to add event handlers using anonymous functions
    <li>convert Javascript into jQuery code
    <li>How to do cloning
  </ul>

<h2 id="sec_solutions">Solutions</h2>

<p id="solutions_later">Will be posted later, visit again after
  <span id="later"></span></p>

<div id="solutions" style="display: none">
<p>Task 1:
<pre class="prettyprint lang-js linenums">
  for(var i=0; i <  images.length; i++ ) {
      var image = images[i];
      $('&lt;img&gt;')
          .attr("src",images.src)
          .attr("alt",images.alt)
          .attr("class",images.class)
          .appendTo('#thumbnails');
  }
</pre>
  
<p>Task 2 (Solution 1 - stand-alone event handler)
<pre class="prettyprint lang-js linenums">
  $('#thumbnails img').click(function () {
        $("#animal img").attr({'src',this.src,'alt',this.alt});
        $("#animal figcaption").text(this.alt);
  });
</pre>

<p>Task 2 (Solution 2 - chaining the click event handler to Task 1 solution)
<pre class="prettyprint lang-js linenums">
  for(var i=0; i <  images.length; i++ ) {
      var image = images[i];
      $('&lt;img&gt;')
          .attr("src",images.src)
          .attr("alt",images.alt)
          .attr("class",images.class)
          // or could use .attr({src: images.src, alt: images.alt, class:images.class});
          .appendTo('#thumbnails')
          .click(function () {
              $("#animal img").attr({src:this.src, alt:this.alt});
              $("#animal figcaption").text(this.alt);
          });
  }
</pre>

<p>Task 3:
  <pre class="prettyprint lang-js linenums">
    $("input").change(function () {
        var klass = $("input:checked").val();  // "class" is a reserved word
        alert("showing: "+klass);
    });
</pre>

<p>Challenge Task:
<pre class="prettyprint lang-js linenums">
$("input").change(function () {
    var klass = $("input:checked").val();
    alert("showing: "+klass);
    if (klass == "all") {
        $("#thumbnails img").show();
    } else {
      $("#thumbnails img").hide();
      $("#thumbnails img."+klass).show();  // note the dot
    }
});
</pre>  
</div><!-- end of solutions -->
<script>
var now = new Date();
var later = new Date("4/13/2015 5:00 PM");
document.querySelector("#later").innerHTML = later.toLocaleString();
if( now > later ) {
    document.querySelector("#solutions").style.display = "block"; // $("#solutions").show();
    document.querySelector("#solutions_later").style.display = "hidden"; // $("#solutions").show();
}
</script>

      </div><!-- end of row -->
    </div><!-- end of class=container -->



    <!--#include virtual="../../modularity/bs-footer.part" -->
    <script src="../../js/TOC.js"></script>
    <script src="/~cs307/js/google-code-prettify/prettify.js"></script>
    <script>insertTOC_textual(); prettyPrint();</script>
    <script>
$("#add_item").click(function () {
    var clone = $("#list2 > li").clone();
    clone.find(".num").text( $("#n").val() );
    clone.find(".good").text( $("#what").val() );
    clone.appendTo("#real_list");
});

      function hideAnswer() {
          // hide a PRE or a P inside the LI (this). Don't hide the
          // whole LI, or the numbering changes.
          $("pre,p",this)
              .css('border-color','red')
              .css('background-color','#FF8080')
              .fadeOut(1000);
      }

      $("li").click(hideAnswer);
    </script>
   </div>
  </div>
  <!--#include virtual="/~cs110/modularity/footer.part" -->
 </div> <!--end of container>
        
        
 <!--#include virtual="/~cs110/modularity/bs-footer.part" -->
  </body>
</html>
