<!DOCTYPE HTML PUBLIC
          "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
<head>
  <title>CS110: Encryption</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="../../cs110-main-style.css">
</head>
<body>

<H1>Encryption and Security</H1>
         
<P><strong><em>Encryption</em></strong> allows machines to <strong><em>communicate 
in a secure way</em></strong>

<p>To introduce methods of encryption, we consider the following         
<em>cast of characters:</em>
         
<UL>
  <LI>Alice, who wants to say something privately to Bob
            
  <LI>Bob, who wants to hear from Alice
            
  <LI>Eve, the person who is trying to eavesdrop on their conversation
</UL>

<p>&nbsp;&nbsp;&nbsp;<img src="aliceBob.jpg" alt="Alice, Bob and Eve" width="400">
         
<p>Messages may be sent by radio, phone, email or carrier pigeon. 
All media are potentially insecure - radio waves can be picked up by other 
receivers, phone wires and computer networks can be tapped, and carrier pigeons 
can be captured.
         
<H2>Ciphers</H2>
         
<P>One approach to secure communication is to <strong><em>put the message in 
code</em></strong> 

<p>Code-making and code-breaking have a long history - some notable examples:

<ul>
  <li> Julius Caesar used so-called <em>Caesar Codes</em> to communicate with
     his troops
  <li> Alan Turing and his code-breakers in England were able to break the
    codes sent by the Germans with the <em>Enigma machine</em> in WWII
  <li> Navajo Indians used their native language as an unbreakable code in the 
    war in the Pacific
</ul>

<p><strong>Encryption terminology:</strong>
         
<ul> 
  <li><strong><em>plaintext:</em></strong> message to be sent, in readable form
  <li><strong><em>ciphertext:</em></strong> message in coded form, unreadable without 
           special information such as a <strong><em>key</em></strong>
  <li><strong><em>encrypt:</em></strong> turn plaintext into ciphertext
  <li><strong><em>decrypt:</em></strong> turn ciphertext back into plaintext
  <li><strong><em>cryptanalysis:</em></strong> cracking a code - attempting to decrypt 
           without the required special information
  <li><strong><em>cryptography:</em></strong> study of codes and code-breaking
</ul>

<!-- from a wiki class by Steven Choy: http://www.stepwise.hk/npwiki/Lecture/terms.png -->

<p>&nbsp;&nbsp;&nbsp;<img src="terms.gif" alt="encryption terminology" width="400">
         
<H2>Caesar Codes</H2>
         
<p>The idea behind Caesar Codes is <strong><em>letter substitution</em></strong>.
One strategy uses <strong><em>rotation:</em></strong> turn the inner wheel and then 
replace the outer letters (plaintext) with those in the inner wheel (ciphertext):

<!-- image from prizecodebreaker.com -->

<p><img src="caesar.jpg" alt="Caesar coding wheel" width="200"
        style="float: left; margin: 5px 30px 20px 10px">
<table style="font-size: large; margin: 30px 10px 30px 20px" border="0">
  <tr><td>plaintext:</td> <td>&nbsp;&nbsp;<code style="font-size: x-large">CAESAR</code></td></tr>
  <tr><td>ciphertext:</td> <td>&nbsp;&nbsp;<code style="font-size: x-large">PNRFNE</code></td></tr>
</table>

<p style="clear: both">
Caesar actually used a rotation of 3, so &ldquo;ATTACK&rdquo; was sent as &ldquo;DWWDFN&rdquo;
         
<P>Another popular Caesar code, called <strong><em>rot13</em></strong> (rotate the
wheel by 13 steps), is used on the Internet to hide things from inadvertent reading, 
such as movie spoilers or dirty jokes
         
<p>Send a message to your neighbor using the following form - 
note that this form converts the string to uppercase and only rotates the letters, 
leaving numbers, punctuation and other characters unchanged:

</div>

<SCRIPT type="text/JavaScript">
A = 'A'.charCodeAt(0); 
Z = 'Z'.charCodeAt(0);

// returns a new string containing one character that is the n-place
// rotation of the first character of s, if s is a string, and the
// character whose ASCII value is s, if s is a number.

function rotate(s, n) {
    if( typeof(s) == "string" ) {
        x = s.charCodeAt(0);
        y = ((x - A + n) % 26) + A;
        return String.fromCharCode(y);
    } else {
        x = s;
        y = ((x - A + n) % 26) + A;
        return y;
    }
}

function rotateAlphabet(n) {
    n = parseInt(n);
    while(n<0) {
       n = n + 26;
    }
    r = '';
    for(i = A; i <= Z; i++) {
        r += String.fromCharCode(rotate(i, n));
    }
    return r;
}
</SCRIPT>

<SCRIPT type="text/JavaScript">

function encrypt(plain,amount) {
    n = parseInt(amount);
    r = '';
    plain =  plain.toUpperCase();
    for(i=0; i<plain.length ; i++) {
        c = plain.charCodeAt(i);
        if( A<= c && c<= Z ) {
            c = rotate(c,n);
        }
        s = String.fromCharCode(c);
        r += s;
    }
    return r;
}

function decrypt(cipher,amount) {
    return encrypt(cipher,26-amount);
}

function encryptForm() {
    p = document.caesar.plaintext.value;
    a = document.caesar.amount.value;
    c = encrypt(p,a);
    document.caesar.ciphertext.value = c;
}

function decryptForm() {
    c = document.caesar.ciphertext.value;
    a = document.caesar.amount.value;
    p = decrypt(c,a);
    document.caesar.plaintext.value = p;
}
</SCRIPT>

<FORM ACTION="" METHOD=POST name=caesar>
            <P><TABLE>
               <TR>
                  <TD>
                     rotation amount:
                  </TD>
                  <TD>
                     <INPUT TYPE=text NAME=amount VALUE="" SIZE=2>
                  </TD>
               </TR>
               <TR>
                  <TD>
                     plaintext:
                  </TD>
                  <TD>
                     <INPUT TYPE=text NAME=plaintext VALUE="" SIZE=30>
                  </TD>
               </TR>
               <TR>
                  <TD>
                     ciphertext:
                  </TD>
                  <TD>
                     <INPUT TYPE=text NAME=ciphertext VALUE="" SIZE=30>
                  </TD>
               </TR>
               <TR>
                  <TD>
                     <INPUT TYPE=button NAME=Button VALUE="Encrypt" onclick="encryptForm()">
                  </TD>
                  <TD>
                     <INPUT TYPE=button NAME=Button VALUE="Decrypt" onclick="decryptForm()">
                  </TD>
               </TR>
 </TABLE>
         
</FORM>
         
<p>How can we use the <strong><em>ASCII table</em></strong> to expand the
characters we can encode?

<p><img src="../compModel/ascii.gif" alt="ASCII character set" width="450">

<H2>Vigenere Cipher</H2>
         
<P>Ciphers based only on letter substitution are easy to break, for example, by
analyzing the frequency of occurrence of letters in the coded message

<p>A <strong><em>Vigenere Cipher</em></strong> spoils the statistics of a simple Caesar 
cipher by using <em>multiple Caesar ciphers.</em> The technique is named for its inventor, 
Blaise de Vigenere from the court of Henry III of France in the sixteenth century, and 
was considered unbreakable for some 300 years!

<p>Using a Vigenere Cipher to encrypt a message:

<ol>
   <li>Select a <em>keyword</em>, such as "CAT"
   <li>Convert the letters of the keyword to a <em>sequence of rotations,</em> 
     each in the range from 0 to 25, e.g. "CAT" is converted to the rotation sequence 
     2-0-19
   <li>Use the sequence of rotations to encode successive letters of the message, repeatedly
     cycling through the rotations, e.g. 2-0-19-2-0-19-2-0-19...
</ol>

<p>It helps to have a table of all the rotations:

<SCRIPT type="text/JavaScript">
//for(i=0; i<13; i++) { document.write("<p>"); }

document.write("<p><table><tr><th>Char<\/th>");

for(i=A; i<=Z; i++) {
   document.write("<th>"+String.fromCharCode(i)+"<\/th>");
}

document.write("<th>&nbsp;&nbsp;&nbsp;Rot<\/th>");
document.write("<\/tr>");
var index=0;
for(j=A; j<=Z; j++) {
    document.write("<tr><th>"+String.fromCharCode(j)+"<\/th>");
    for(i=A; i<=Z; i++) {
        document.write("<td>"+String.fromCharCode(rotate(i,j-A))+"<\/td>");
    }
    document.write("<td>&nbsp;&nbsp;&nbsp;&nbsp;" + index + "<\/td><\/tr>");
    index = index + 1;
}
document.write("<\/table>");
</SCRIPT>
         
<p>Encryption using a Vigenere Cipher with the keyword "CAT":
         
<TABLE style="margin-left: 15px" border="0">
               <TR>
                  <TD>
                     keyword:&nbsp;&nbsp;&nbsp;
                  </TD>
                  <TD>
                     <CODE style="font-size: x-large">CATCATCATCATCA</CODE>
                  </TD>
               </TR>
               <TR>
                  <TD>
                     plaintext:&nbsp;&nbsp;&nbsp;
                  </TD>
                  <TD>
                     <CODE style="font-size: x-large">ATTACK AT DAWN</CODE>
                  </TD>
               </TR>
               <TR>
                  <TD>
                     ciphertext:&nbsp;&nbsp;&nbsp;
                  </TD>
                  <TD>
                     <CODE style="font-size: x-large">CTMCCD AM DTYN</CODE>
                  </TD>
               </TR>
            </TABLE>
         
<P><strong>Hmmmm...</strong> the two T's in &ldquo;ATTACK&rdquo; are encrypted differently, 
and the letter &ldquo;A&rdquo; is encrypted four times, yielding three different results
(C, A and T) - <strong><em>Why?</em></strong>
         
<H2>Enigma</H2>

<!-- image from churchwell.co.uk -->

<p><img src="enigma.jpg" alt="Enigma machine" width="130"
        style="float: left; margin: 0px 20px 15px 10px">

<P>The Vigenere cipher is an example of a <strong><em>polyalphabetic cipher</em></strong>
<p>The Germans' Enigma machine also used a polyalphabetic cipher that they thought was 
unbreakable. The Enigma machine looked
like a manual typewriter with keys and hammers, but internally the keys
were attached to drums that implemented letter substitutions by
mapping the keys to different hammers. There were 3-4 rotors that did the
substitutions and after each letter was typed, the rotors turned like
a car odometer (the rightmost fastest, and so on).
         
<P>The British stole one of the machines and needed the keyword
(settings of the rotors) to break the code. A group of mathematicians led 
by Alan Turing (including quite a few women!) analyzed the 
transmissions and eventually cracked the code. This was a major turning point 
in the war, and the Allies went to enormous effort and sacrifice to conceal 
the fact that they had cracked the code.
         
<H2 style="clear: both">Private Key Encryption</H2>

<p>Returning to the saga of Alice and Bob, the above encryption methods
are examples of <strong><em>private key encryption</em></strong> and
require a <strong><em>shared private key:</strong></em>

<!-- from a wiki class by Steven Choy: http://www.stepwise.hk/npwiki/Lecture/terms.png -->

<p>&nbsp;&nbsp;&nbsp;<img src="terms.gif" alt="encryption terminology" width="400">
         
<P>For thousands of years, this was the essential paradox of
encryption: <em>you had to have a secure way of communicating in order to have
a secure way of communicating</em> - a real-life chicken-and-egg problem!
         
<H2>Public Key Encryption</H2>

<p><img src="rsa.jpg" alt="Shamir, Rivest and Adleman" width="200"
        style="float: left; margin: 0px 20px 10px 10px">         

<P style="margin-top: 20px">In 1976, Whitfield Diffie and Martin Hellman solved the problem of
deriving a shared private key over an insecure channel, an invention
known as Diffie-Hellman key exchange.  
A year later, three MIT professors (Ron Rivest, Adi Shamir and Leonard Adleman)
created the first practical implementation of <strong><em>public
key encryption</em></strong>, known as the
<a href="http://en.wikipedia.org/wiki/RSA"><strong><em>RSA method</em></strong></a>

<p style="clear: both">The main ideas of a public key cryptosystem:
         
<UL>
     <LI>Instead of one key, you have <EM>two</EM>: one to encrypt and a
     different one to decrypt
            
     <LI>The encryption key can be <EM>public</EM>
            
     <LI>Knowing the encryption key doesn't help you figure out the
     decryption key
</UL>

<!-- based on image from http://universe-review.ca/R13-11-QuantumComputing.htm -->

<p><img src="public.jpg" alt="diagram of public key encryption" width="400">
         
<P>How does this help? Bob knows that Alice wants to send him
a message, and creates a pair of keys.  He advertises his public key,
maybe on his web page! Alice sees it, and so does Eve. Alice uses the public key to encrypt 
her message, and sends it to Bob. Eve intercepts the message, but can't decrypt it
&mdash; only Bob can decrypt the message, because only Bob has the secret key.
         
<H2>Public Key Encryption in Practice</H2>
         
<P>The description of public key encryption is simple, but the implementation is not.  
The RSA method involves advanced number theory. The pair of keys 
are mathematically related &mdash; you can generate them efficiently and use them to
encrypt and decrypt messages, but trying to determine one key from the other 
involves solving a problem that is mathematically &ldquo;hard.&rdquo;
This makes the RSA method difficult to crack.  For their
contribution, the RSA team won the Turing Award,
considered the Nobel-equivalent for Computer Science.
         
<h2>Secure Communications</h2>

<P>When you access a <strong><em>secure web server</em></strong>, your browser and 
the server become Alice and Bob. Public key encryption is used to establish a 
cryptographically secure connection, so credit card numbers and other private 
information is safe from the Eves on the network connections between your browser
and the server:
         
<blockquote>
<p><img src="../M13-cookies/setup.png" alt="setting up secure communication" width="350">
</blockquote>

<ol>
<li>The browser makes an <strong>HTTPS</strong> request to the server for secure
communication

<li>The server responds by sending a digital "trunk" &mdash <em>only</em> the server 
has the key that unlocks the trunk, but anyone can put something in the trunk and lock it

<li>The browser makes up a <em>secret code</em>, puts it in the trunk,
closes the lid, and sends it to the server. Only the server can unlock the trunk, 
so no one along the path can get the secret code

<li>The server unlocks the trunk, gets the secret code, and uses it to
securely transmit the page. The server and browser can then communicate in both 
directions using the secret code, and no one else can read their conversation
</ol>

<P><strong><em>But is your information really safe? Not entirely... </em></strong>

<p>The communications are secure, but the web server itself can be compromised.
A famous security expert once joked: 

<blockquote>
<p><em>[It's] like using an armored truck to deliver cash from someone who
lives on a park bench to someone who lives in a cardboard box</em>
</blockquote>

<p><strong>Moral:</strong> If you're worried, read the security
information on the website!  Ideally, personal information (credit card
numbers, social security numbers, whatever), should not be stored at all.
Failing that, it should be stored on a separate computer.

<h2>Spoofing</h2>

<p><strong><em>Spoofing</em></strong> means to impersonate a website - it takes 
some hacking ability, but that's common enough. Let's make some (illegal) money: 

<ul>
    <li>Set up a web server that <em>claims</em> to be Amazon.com
    <li>Fake a bunch of web pages (by copying some of theirs)
    <li>Wait for people to order merchandise by credit card
    <li>Take their credit cards and buy stuff
</ul>

<p>What can be done about this?  How do we deal with possible
impersonation in real life?  We have <em>id cards</em>.

<h2>Certificates and Signing Authorities</h2>

<p>
Imagine that the "trunk" from the secure server is <em>labeled</em> with the 
owner's name and <em>signed</em> by some <em>authority</em>, just as a driver's 
license has the signature of a state official on it.
Of course, the electronic signature is <em>digital</em>. The signed, 
identified trunk is called a <em>certificate</em>.

<p>A signature can only come from a valid <em>signing authority</em> - 
a company that makes money signing trunks, such as "Verisign."  
The IT people at Amazon.com go to Verisign,
prove that they are valid representatives of Amazon.com, and present
their trunk for signature.  Verisign signs the trunk, and Amazon.com
is now ready to set up a secure server. We now have:

<blockquote>
<p><img alt="secure communication with signatures" src="../M13-cookies/setup2.png" 
       width="350">
</blockquote>

<ol>
<li>The browser requests a web page via HTTPS

<li>The server replies with a certificate &mdash; a signed, labeled trunk

<li>The browser verifies the signature and whether it trusts the signer &mdash;
if they check out, it uses the trunk to send a secret code to the server

<li>The server unlocks the trunk and uses the secret code to send the web page securely
</ol>

<h2>Whom do you Trust?</h2>

<p>In Firefox, go to <code>Firefox>Preferences...</code>, then click on
     <code>Advanced</code>, select the <code>Encryption</code> tab,
     and click on <code>View Certificates</code>.  This displays
     the certificates we've accepted

<p>The signing authority doesn't guarantee that the company is a fine,
upstanding pillar of the community, any more than a driver's license
does &mdash; it just guarantees that the owner is who it claims to be

</body>
</html>
