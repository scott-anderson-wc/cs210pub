<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Class Activities</title>
    <!--#include virtual="../../modularity/bs-head.part" -->
    <link rel="stylesheet" type="text/css" href="http://cs.wellesley.edu/~cs307/js/google-code-prettify/prettify-sda.css">
    
  <script src="http://google-code-prettify.googlecode.com/svn/loader/prettify.js"></script>

    <style>
      #TOC_list {list-style-type: none;}
      ul li { margin-top: 15px;}
      ul {list-style-type: square}
    </style>
    
  </head>
  <body>
    <!--#include virtual="../../modularity/navbar.part" -->

    <div class="container">
      <h1>User-defined Functions</h1>
      <hr>
    </div>
      
    <div class="container">
      <div class="row">
     
        <div class="col-md-3">
          <div class="bs-sidebar hidden-print" role="complementary">
            <ul class="nav bs-sidenav">  
              <div id="insert_TOC_here"></div>
            </ul>
          </div>
        </div>

        <div class="col-md-9">
        
        <h2>Functions: A Summary</h2>
        
        <p>Here are some important things about functions. These were lifted from one of the
        great books of the Head First Series, Head First JavaScript Programming.
        
        <ul>
<li>Declare a function using the <code>function</code> keyword, followed by the name of the function.
<li>Use parentheses to enclose any <strong>parameters</strong> a function has. Use empty parentheses if there are no parameters.
<li>Enclose the body of the function in curly braces.
<li>The statements in the body of a function are executed when you call a function.
<li>Calling a function and invoking a function are the same thing.
<li>You call a function by using its name and passing <strong>arguments</strong> to the function’s parameters (if any).
<li>A function can optionally return a value using the <code>return</code> statement.
<li>A function creates a local scope for parameters and any local variables the function uses.
<li>Variables are either in the <strong>global scope</strong> (visible everywhere in your program) or in the local scope (visible only in the function where they are declared).
<li>Declare <strong>local variables</strong> at the top of the body of your function.
<li>If you forget to declare a local variable using <code>var</code>, that variable will be global, which could have unintended consequences in your program.
<li>Functions are a good way to organize your code and create reusable chunks of code.
<li>You can customize the code in a function by passing in arguments to parameters (and using different arguments to get different results).
<li>Functions are also a good way to reduce or eliminate duplicate code.
<li>You can use JavaScript’s many built-in functions, like <code>alert</code>, <code>prompt</code>, and <code>Math.random</code>, to do work in your programs.
<li>Using built-in functions means using existing code you don’t have to write yourself.
<li>It’s a good idea to organize your code so your functions are together, and your global variables are together, at the top of your JavaScript file.
</ul>

 <h2>Understand and Modify</h2> 
  
  <p>In the following there is an example of a webpage that use Javascript functions. Your task
  is to understand what the code does and then perform certain modifications that will allow you
  to reuse the code in different situations.</p>
  
  <h3>Pronouncing English Words</h3>
  <p>The <a href="/~cs110/documentation/js-examples/play_audio.html" target="_blank">first example</a> uses a Javascript function to add an audio element on the fly to a page. Press each button to hear the sound.
    Then look at the source of the page. The relevant part is this:</p>
    
<pre class="prettyprint">
&lt;div id="words"&gt;
  &lt;p&gt;&lt;span&gt;apple&lt;/span&gt;&lt;img src="icons/play.png" alt="sound icon"&gt;&lt;audio&gt;&lt;/audio&gt;&lt;/p&gt;
  &lt;p&gt;&lt;span&gt;pomegranate&lt;/span&gt;&lt;img src="icons/play.png" alt="sound icon"&gt;&lt;audio&gt;&lt;/audio&gt;&lt;/p&gt;
  &lt;p&gt;&lt;span&gt;watermelon&lt;/span&gt;&lt;img src="icons/play.png" alt="sound icon"&gt;&lt;audio&gt;&lt;/audio&gt;&lt;/p&gt;
  &lt;p&gt;&lt;span&gt;cucumber&lt;/span&gt;&lt;img src="icons/play.png" alt="sound icon"&gt;&lt;audio&gt;&lt;/audio&gt;&lt;/p&gt;
&lt;/div&gt;    
</pre>
  
  <p>As you can notice, the <code>audio</code> tag is empty, and the sound is added by the Javascript
    code whenever the sound icon image that serves as a button is clicked.
  
  <p>Here is the JavaScript code that automatically adds the event handler <code>playSound</code>
    to every <code>img</code> element. This is very similar to what we did in the 
    <strong>Animal Gallery example</strong>.
  </p>
  
  <pre class="prettyprint lang-js">
// get the list of img elements that are sound icons
var iconsList = document.querySelectorAll("#words img");
        
// iterate through the list to bind to every element the event handler
// for the onclick event
for (var i=0; i &lt; iconsList.length; i++){
    var icon = iconsList[i];
    icon.onclick = playSound;
}</pre>
  <p>Notice the use of the <code>document.querySelectorAll</code>. Differently from 
  <code>document.querySelector</code> which returns only the first element it finds
  the first method returns <strong>all</strong> elements defined by the selector as an array
  of elements. Try it out in the console to see it for yourselves. </p>
  
  <p>Below is the code for the <code>playSound</code> function. Notice that it uses
  the special variable <code>this</code> to refer to the clicked icon. Then it uses
  the DOM structure (the fact that the element <code>img</code> has two siblings, one
  on each side) to access them and get the word from the previous sibling and set the audio
  attributes to the next sibling.</p>
  
  <pre class="prettyprint lang-js">  
function playSound(){

  console.log(this) // Check that it refers to the &lt;img&gt; element

  //get the text from the &lt;span&gt; element that is its previous sibling
  //Check the HTML code to see that &lt;img&gt; and &lt;span&gt; are siblings.
  var word = this.previousSibling.innerHTML;

  // get the &lt;audio&gt; element which is its next sibling
  var audio = this.nextSibling;

  // specify values for the attributes of the &lt;audio&gt; element
  // notice how the URL is generated by concatenating a fixed part 
  // with the concrete word
  var attributes = {src: "https://ssl.gstatic.com/dictionary/static/sounds/de/0/" + word + ".mp3",
                                      autoplay: "autoplay",
                                      type: "audio/mpeg"};

  // set the attributes of the &lt;audio&gt; element, so that it can play the sound
  for (property in attributes) {
          audio.setAttribute(property, attributes[property]);
      }         

}
  </pre>
  <p>Finally, notice the special use of the <code>for</code> loop with the properties of an object.
  We are using the for loop, so that we don't need to call the method <code>setAttribute</code>
  many times for each attribute we want to set.</p>
  
  <h4>Modify</h4>
  <p>Now that you know how the example works, modify the code for your purposes. Here are some
  ideas, but feel free to pursue your own ideas:</p>
  <ol>
  <li>Write an HTML page that has a simple form that asks the user to enter one English word.
    Modify the <code>playSound</code> function to read the word from the input and then pronounce it.
    Note: not all English words are in the dictionary. You can check the console to see for words
    that were not found, you'll see a GET error.</li>
  <li>Write a second HTML page that instead of a form it has an array of many words and it randomly
    selects one everytime a button "Show Word" is clicked and displays it on the page. 
    Then, add a button "Pronounce" that 
    will play the audio of the word. Modify the <code>playSound</code> method so that now it works
    for both pages. For that, you'll need to use parameters for the input word and the audio element,
    so that the function is independent of the HTML elements of the page. Then, invoke
    your function with arguments, depending on which page is using it.</li>
  </ol>
           </div><!-- end of row -->
    </div><!-- end of class=container -->



    <!--#include virtual="../../modularity/bs-footer.part" -->
    <script src="../../js/TOC.js"></script>
    <script src="/~cs307/js/google-code-prettify/prettify.js"></script>
    <script>insertTOC_textual(); prettyPrint();</script>
    <script>
      function hideAnswer() {
          $("pre",this)
              .css('border-color','red')
              .css('background-color','#FF8080')
              .fadeOut(1000);
          $("p",this)
              .css('border-color','red')
              .css('background-color','#FF8080')
              .fadeOut(1000);
      }

      $("li").click(hideAnswer);
    </script>
   </div>
  </div>
  <!--#include virtual="/~cs110/modularity/footer.part" -->
 </div> <!--end of container>
        
        
 <!--#include virtual="/~cs110/modularity/bs-footer.part" -->
  </body>
</html>
