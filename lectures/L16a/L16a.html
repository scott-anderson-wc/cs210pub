<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Class Activities</title>
    <!-- use relative pathnames in #include so when this site is archived,
         say as cs110f15, the include refers to the same file -->
    <!--#set var="reltop" value="../../" -->
    <!--#include virtual="../../modularity/bs-head-rel.part" -->
    <style>
      #TOC_list {list-style-type: none;}
    </style>
    
  </head>
  <body>
    <!--#include virtual="../../modularity/navbar-rel.part" -->

    <div class="container">
      <h1>Forms, Events and Event Handlers</h1>
      <hr>
    </div>
      
    <div class="container">
      <div class="row">
     
        <div class="col-md-3">
          <div class="bs-sidebar hidden-print" role="complementary">
            <ul class="nav bs-sidenav">  
              <div id="insert_TOC_here"></div>
            </ul>
          </div>
        </div>

        <div class="col-md-8">
          
<h2>Goal</h2>

<p>By the end of today, you will be able to:
  <ol>
    <li>use the appropriate vocabulary to talk about events and event handlers
      
    <li>define a function to act as an event handler
      
    <li>attach it to the DOM
      
  </ol>

<h2>Function Review: Definition, Invocation, Parameters, Arguments</h2>

<p>Imagine we have a function that will check to see if a triple of
  numbers are a Pythagorean triple, namely that:
  <blockquote>a<sup>2</sup>+b<sup>2</sup>=c<sup>2</sup></blockquote>

<p>Here's the <em>definition</em> of the function:
  <pre id="dst1" class="prettyprint lang-js">
</pre>

<script id="src1">
function isPythTriple(a,b,c) {
   if( a*a + b*b == c*c ) {
       return true;
   } else {
       return false;
   }
}
</script>

<script>
$("#dst1").text($("#src1").text());
</script>

<p>(Can you think of a more succinct definition?)

<p>Here are some <em>invocations</em> of the function:
<pre class="prettyprint lang-js line-numbers">
isPythTriple(1,2,3);
isPythTriple(3,4,5);
isPythTriple(5,3,4);
isPythTriple(5,11,12);
isPythTriple(5,12,13);
x = 3; y = 4; z = 5;
isPythTriple(x,y,z);
isPythTriple(z,x,y);
</pre>

<p>Open up your JS console and try some!

<p>Questions:
  <ul>
    <li>What's the difference between a definition and an invocation? 
    <li>What's the difference between an argument and a parameter?
    <li>Does it matter what order the arguments are in?
    <li>How can you tell what value each parameter will have?
    <li>What does <code>return</code> do?
  </ul>

<h2>Purely Functional Functions</h2>

<p>The <code>isPythTriple</code> function, above, has no side-effects. It
  doesn't pop up any alerts and it doesn't prompt for input. It doesn't
  modify the page. How can it do anything useful?

<p>Actually, functions like that can be very useful, because they aren't
  tied to a particular problem. Maybe the argument values come from a form
  that the user fills out. Maybe they come from
  using <code>prompt</code>. Maybe they are numbers that are randomly
  generated, searching for more triples.  It doesn't matter; this function
  will still accept them and report whether they meet the criteria.

<p>The <em>use</em> of that return value is similarly undetermined. It
  might be reported to the user, it might be used to control a loop (stop
  looping when you find a triple), or it might be to grade an exam (did
  the user enter a correct triple?). Again, it doesn't matter. This
  function just does its job and doesn't worry about the larger
  context.</p>

<p>We will often do this. In fact, we did on the homework.</p>

<h2>Hw6 Questions</h2>

<p>Let's look at the following:
  <ul>
    <li>What does task 4 do? How does it get its input? What side-effects
      does it have? What does it do with its results?</li>
      
    <li>What do tasks 1-3 do? How do they get their input? What
      side-effects do they have? What do they do with their results?</li>
    
  </ul>

<h2 id="recap">Recap</h2>

<p>We learned about <em>forms</em> and <em>event handlers</em>.

<h2>Forms</h2>

<ul>
  <li>The <code>form</code> tag is a wrapper for a set of <em>inputs</em>
    or <em>controls</em>.
    
  <li>Most controls use the <code>input</code> tag. There are some fancy
    new ones (with types like <code>email</code> or <code>phone</code>), but
    the old-fashioned <code>type=text</code> is universally supported.
    
  <li>Larger chunks of text can be entered with a <code>textarea</code>,
    with attributes of <code>rows</code> and <code>cols</code>.

  <li>Pull-down menus use the <code>select</code> tag, with each menu item
    using the <code>option</code> tag.
   
  <li>There's also a <code>button</code> tag, and its near
    twin, <code>input type="button"</code>
    
  <li><code>submit</code> buttons submit the form. For now, we'll
    use <code>type=button</code>, for a button that is <em>just</em> a
    button. That's the one we'll attach an event handler to.
    
</ul>

<h2>Event Handlers</h2>

<ul>
  <li>An event handler is a <em>function</em> that is
    <ul>
      <li>attached to an element and associated with an <em>event</em>
        
      <li>is invoked by the <em>browser</em> when the event occurs with
        that element.
    </ul>

  <li>Event handlers typically take no arguments and return no
    values. They work entirely by <em>side-effect</em>.

  <li>While an event handler is executing, the special
    variable <code>this</code> is bound to the target of the event (for
    example, the element that was clicked on). 

</ul>

<p>We also learned about jQuery's <code>.val()</code> method, which
  retrieves the value of a form control.

<h2>Pattern: Separating Calculation from Interface</h2>

<p>In the <a href="../../reading/events.html">events</a> reading, we saw
  this example of a <a href="../../reading/events.html#form_lb2kg">form
  to convert pounds to kilos</a>:

<form id="form_lb2kg" class="demo">
  <p><label for="pounds2">Pounds</label>
    <input type="text" name="pounds" id="pounds2">
  <p><button type="button" id="convert2">Convert</button>
  <p><span id="kg2"></span> kilograms</p>
</form>

<script id="convert_src">
function pounds2kilograms(pounds) {
    return pounds / 2.20462;
}

function doConversion() {
    var lbs = parseFloat( $("#pounds2").val() );
    var kgs = pounds2kilograms(lbs);
    $("#kg2").html( kgs.toFixed(1) );
}

$("#convert2").click(doConversion);
</script>

<p>Here's the code:

<pre id="convert_dst" class="prettyprint lang-js linenumbers"></pre>

<script>
document.getElementById("convert_dst").innerText = document.getElementById("convert_src").innerText;
</script>

<p>Notice that we defined two separate functions. One is a generally
  useful function to convert pounds to kilograms; we could imagine using
  it in lots of problem-solving.  The second is a very specific function
  to pull some data out of a particular form and insert an answer into a
  place on the page. It would be hard to imagine re-using this function
  elsewhere.  However, it makes an excellent event-handler.

<p>This pattern is very common. It's good practice to write code that is
  generally useful and could be re-used in other contexts and for other
  purposes.  We can't do that if the code is intermingled with stuff that
  is very tied to a particular situation. So, we separate the
  problem-specific stuff from the general stuff.</p>

<h2>Our Destination</h2>

<p>We're going to build the following
    form: <a target="_blank" href="../../solutions/colorslider/slider-scott-v5b.html">colorslider</a> (instructor only).

<p>No, I'm not going to show you the source
  code. <span style="font-size: x-large;">&#9786;</span></p>

<h2>Quiz Question Nr. 1</h2> 

<p>Which of the following creates a slider from 0 to 100, with the
  initial value of 50?

<ol type="A">
  <li>
<pre class="prettyprint">&lt;input type="range" min=0 max=100 value=50&gt;</pre>

<li>
  <pre class="prettyprint">&lt;input type="slider" start=0 finish=100 value=50&gt;</pre>

<li>
  <pre class="prettyprint">&lt;input type="range" start=0 finish=100 value=50&gt;</pre>

<li>
  <pre class="prettyprint">&lt;input type="slider" min=0 max=100 value=50&gt;</pre>
</ol>

<h2>Exercise 1: Build a Page with a Form</h2>

<p>Build the page and form above. You can start with the
  following <a target="_blank" href="http://jsfiddle.net/amz9mws5/">jsfiddle</a>.

  <ul>
        
        <li>You won't need any JavaScript for this exercise; this one is
        pure HTML
          
        <li>Add the elements necessary to create the form.

        <li>Make sure to have a span that can hold the current slider
        value, one span for each slider
          
        <li>Give the span an ID so that you can change its contents. I
        think it's a good idea to give each slider an ID, too, though it's
        not strictly necessary.
          
        <li>Create a button, with <code>type="button"</code>, that we'll later use to
        set the color.
          
      </ul>

<p>Your solution might look like
  this: <a target="_blank" href="slider-scott-v1.html">v1</a>.  Some notes on the
  solution:</p>
<ul>
  <li>You need a <code>&lt;form&gt;</code> tag as a <q>wrapper</q>
    for the whole form.

  <li>Form elements are <em>inline</em>, so we put them on different
    lines using the <code>&lt;p&gt;</code> tag.
    
  <li>We use the <code>&lt;span&gt;</code> element as a place to put
    the values we report. They can initially be empty.
    
  <li>The <code>&lt;label&gt;</code> elements are not required
    for the form to work. They're there to improve accessibility
    
  <li>The <code>&lt;button&gt;</code> tag creates the <q>set
      color</q> button.  Currently it does nothing.
</ul>


<h2>Quiz Question Nr. 2</h2> 

<p>Which of the following replaces the contents of a div whose ID
  is <code>quest</code> with the text "to seek the grail"?</p>

<ol type="A">
  <li>
<pre class="prettyprint lang-js">
$(quest).html("to seek the grail");
</pre>

  <li>
<pre class="prettyprint lang-js">
$("#quest").innerHTML("to seek the grail");
</pre>

  <li>
<pre class="prettyprint lang-js">
$(".quest").html("to seek the grail");
</pre>

  <li>
<pre class="prettyprint lang-js">
$("#quest").html("to seek the grail");
</pre>  

</ol>


<h2>Quiz Question Nr. 3</h2>

<p>Which of the following implements a button that says "Some call me
  ... Tim!" when clicked on?

<p>Here's a demo:  <form><button type="button" id="tim_button">what is your name?</button></form>
<script>
function iamTim() {
   alert("Some call me ... Tim!");
}
$("#tim_button").click(iamTim);
</script>

<ol type="A">
  <li>

<pre class="prettyprint">
&lt;button type="button" id="tim_button"&gt;what is your name?&lt;/button&gt;
function iamTim() {
   alert("Some call me ... Tim!");
}
$("#tim_button").onclick(iamTim);
</pre>

  <li>

<pre class="prettyprint">
&lt;button type="button" id="tim_button"&gt;what is your name?&lt;/button&gt;
function iamTim {
   alert("Some call me ... Tim!");
}
$("#tim_button").click(iamTim);
</pre>

  <li>

<pre class="prettyprint">
&lt;button type="button" id="tim_button"&gt;what is your name?&lt;/button&gt;
function iamTim() {
   alert("Some call me ... Tim!");
}
$("#tim_button").click(iamTim);
</pre>

  <li>

<pre class="prettyprint">
&lt;button type="button" id="tim_button"&gt;what is your name?&lt;/button&gt;
function iamTim() {
   alert("Some call me ... Tim!");
}
$("#tim_button").click(iamTim());
</pre>  
    </ol>

<p>Observations:
  <ul>
    <li>When the script is read, the function is <em>defined</em>.
    <li>When we click on the button, the function is <em>invoked</em>.
    <li>The definition shows a <em>pattern</em> for <em>how</em> the
      function will be invoked.
  </ul>

<p>Discussion:
  <ul>
    <li>We always use parens in the function definition.

    <li>We use parens after a function name when we <em>invoke</em> it.
      
    <li>When we attach it to an element as an event handler, we
      are <em>not</em> invoking it.
  </ul>


<h2>Quiz Question Nr. 4</h2>

<p>Which of the following functions would copy the value of the red slider
  (ID is <code>Rslider</code>) to the span whose ID
  is <code>redVal</code>?

<ol type="A">
  <li>

<pre class="prettyprint lang-js">
    function showRed() {
        var rVal = $("#Rslider").val();
        $("#redVal").html = rVal;
    }
</pre>

  <li>

<pre class="prettyprint lang-js">
    function showRed() {
        var rVal = $("#Rslider").value();
        $("#redVal").html(rVal);
    }
</pre>

  <li>

<pre class="prettyprint lang-js">
    function showRed() {
        var rVal = $("#Rslider").val();
        $("#redVal").html(rVal);
    }
</pre>

  <li>

<pre class="prettyprint lang-js">
    function showRed() {
        var rVal = $("#redVal").val();
        $("#Rslider").html(rVal);
    }
</pre>

</ol>

    <h2>Exercise 2: Add functions to update slider values</h2>

    <ul>
      
      <li>If you didn't finish the previous exercise, copy/paste my
      solution to your jsfiddle and use that. Or, you can use
      this <a target="_blank" href="http://jsfiddle.net/v4Lr4qb5/">jsfiddle #2</a>

      <li>Define a function like <code>showRed</code> above that looks up
        the value of the red slider and inserts it into the appropriate
        span.
        
      <li>You can also visit my <a target="_blank" href="slider-scott-v1.html">solution to
      ex1</a> and use the JS console to test your function by hand.
        
      <li>Add the function as an event handler for
      the <code>onChange</code> event on the slider, using
      jQuery's <code>change</code> method:

        <pre class="prettyprint lang-js"> $(selector).change(func); </pre>

      <li>Once it works, add similar ones for green and blue.        

    </ul>

    <p>Your solution might work like
      this: <a target="_blank" href="slider-scott-v2a.html">v2a</a>

<h2>The hexByte function</h2>

<p>The activities on functions, last week, included the development of
  a <code>hexByte</code> function. Here's a different implementation,
  using the fact that numbers have a <code>.toString()</code> method that
  takes as its argument the number base to convert to.
  
<p>Open the JS console and try some of the following:
  <pre class="prettyprint lang-js">
var a = 7; a.toString(16);
var b = 11; b.toString(16);
var c = 17; c.toString(16);
var d = 255; d.toString(16);
</pre>

<p>Here's the definition of a <code>hexByte</code> function that does that
  and a little bit more, returning a 2-digit string in hexadecimal. It
  also ensured that the value is a number by
  using <code>parseInt()</code>.

<pre id="dst2" class="prettyprint lang-js">
</pre>

<script id="src2">
function hexByte(val) {
    var num = parseInt(val);
    if( num < 16 ) {
        return "0"+num.toString(16);
    } else {
        return ""+num.toString(16);
    }
}              
</script>

<script>
document.getElementById("dst2").innerText = document.getElementById("src2").innerText;
</script>

<p>Open the JS console and try some of these:
<pre class="prettyprint lang-js">
hexByte(2);
hexByte(55);
hexByte(255);
</pre>
  

<h2>Exercise: hexColor function</h2>

<p>Define a function named <code>hexColor</code> that takes three
  parameters, one for each color primary, and returns a color
  specification using the hexadecimal notation, like <code>#3399FF</code>.
  Don't forget to glue on the leading hash mark. The return value will be
  a string.  Feel free to use the <code>hexByte</code> function if that's
  useful. (Hint: it is.)

  <pre class="prettyprint lang-js">
// function definition here





// sample output:
alert( hexColor(51, 128, 255) ); // should be #3380ff
alert( hexColor(0, 9, 192) ); // should be #0009C0
</pre>
<div>
<textarea rows=8 cols=100>

</textarea><br>
<button onclick="eval(this.parentNode.firstElementChild.value);">Execute it</button> 
</div>         


<p>Your solution might look like this:

<div class="hidden_from_student">
  <pre id="act1_src" class="prettyprint lang-js executable">
function hexColor(red,green,blue) {
    return "#"+hexByte(red)+hexByte(green)+hexByte(blue);
}

// sample output:
alert( hexColor(51, 128, 255) ); // should be #3380ff
alert( hexColor(0, 9, 192) ); // should be #0009C0
  </pre>
</div>
  
<p>Thank goodness for functions! Think of what a mess that code would be
  if we didn't have the <code>hexByte</code> function! That function makes
  the code for <code>hexColor</code> clear, concise and correct.

<h2>Long Exercise: Processing Color Values</h2>

<p>Do the following, testing after each step.
<ol>

  <li>If you didn't finish the previous exercise, save my solution to your
    desktop and use that for this exercise, or copy/paste it to your
    jsfiddle: <a target="_blank" href="slider-scott-v2a.html">v2a</a>.

    <p>Or, use this
    <a target="_blank" href="http://jsfiddle.net/o5ccttgk/2/">jsFiddle #3</a>

  <li>Define a function called <code>setColor</code>that looks up
    the <em>numeric</em> value of each slider (hint,
    use <code>parseInt</code> on the value).

  <li>The function should then use <code>hexColor</code> to convert it to
    a color string.
    
  <li>The function takes the finished string and inserts it into the color
    value span.

  <li>The function takes the finished string and assigns it as the value
    of the <code>background-color</code> CSS property of
    the <code>#box</code>.
        
  <li>Add the finished function as an event handler for
      the <code>click</code> event on the <q>set color</q> button, using
      the jQuery <code>$(...).click(func)</code> method.
</ol>

    <p>Your solution might work like
    this: <a target="_blank" href="slider-scott-v5d.html">v5d</a>
      or this: 
    <a target="_blank" href="http://jsfiddle.net/o5ccttgk/3/">jsFiddle #4</a>


<h2>Summary</h2>

<p>We hope that after these activities you have a good understanding of:
  <ul>

    <li>Defining and invoking functions.
    <li>Using functions as event handlers.
    <li>Using jQuery to modify a page and attach event handlers.
    <li>Defining functions that return a value
    </ul>

<h2 id="sec_solutions">Solutions</h2>
  
<p id="solutions_later">Will be posted later, visit again after
  <span id="later"></span>.</p>

<div id="solutions">

<p>Quiz questions:
<pre>
1. A
2. D
3. C
4. C
</pre>

                </div>

    <!--#include virtual="/~cs110/modularity/footer-rel.part" -->
    
    </div> <!--end of container>
        
        
    <!--#include virtual="/~cs110/modularity/bs-footer-rel.part" -->
    <script src="../../js/date-functions.js"></script>
    <script>
      revealLater("03/29/2016 1:00 PM"); 
   </script>

  </body>
</html>
