<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>

<!-- Adapted from http://www.hanewin.net/encrypt/rsa/rsa-test.htm on 2011-11-20 -->

<title>RSA Public Key Encryption Only</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta content="MSHTML 5.50.4912.300" name="GENERATOR">

<script src="rsa/rsa.js" type="text/javascript"></script>
<script src="rsa/base64.js" type="text/javascript"></script>
<script src="rsa/hex.js" type="text/javascript"></script>
<script src="rsa/keygen.js" type="text/javascript"></script>
<script src="rsa/sda_functions.js" type="text/javascript"></script>

<script language="Javascript" type="text/javascript">



function RSAdoEncryption()
{
 var mod=new Array();
 var exp=new Array();
 
 var s = r2s(document.t.pkey.value);
 var l = Math.floor((s.charCodeAt(0)*256 + s.charCodeAt(1)+7)/8);

 mod = mpi2b(s.substr(0,l+2));
 exp = mpi2b(s.substr(l+2));

 var p = document.rsatest.plaintext.value+String.fromCharCode(1);
 var pl = p.length;

 if(pl > l-3)
 {
    alert('In this example plain text length must be less than modulus of '+(l-3)+' bytes');
    return;
 }

 var b=s2b(p);

 var t;
 var i;

 var startTime=new Date();
 var enc=RSAencrypt(b,exp,mod);
 var endTime=new Date();

 document.rsatest.ciphertext.value=s2hex(b2s(enc));
 document.rsatest.howLong.value=(endTime.getTime()-startTime.getTime())/1000.0;
}

</script>
</head><body bgcolor="#ccccff">
<h2 align="center">RSA Public Key Sender Form</h2>
<center><font size="-1">2005 Herbert Hanewinkel, adapted from John Hanna's RSA implementation</font></center>
<hr>
<center>[<a href="http://www.hanewin.net/encrypt/rsa/rsa.htm">Description</a>] [Test]</center>
<p>
</p><form name="t">
<table>
<tbody>

<tr><td>Public exponent (e):</td><td><input size="10" name="e" readonly="readonly"></td></tr>
<tr><td>Public Modulo (p*q):</td><td><input size="80" name="pq" readonly="readonly"></td></tr>
<tr><td>&nbsp;</td></tr>
<tr><td>OpenPGP Multi Precision Integer<br>(MPI) of Public Key (base64):</td>
<td><input size="80" name="pkey"></td></tr>
<tr><td align="right"><input type="button" value="unpack public key" onClick="unpackPublicKey()">
</tbody></table>

</form>
<p></p>
<hr>
<form name="rsatest">
<table><tbody><tr><td>Plaintext:</td>
<td colspan="2"><input size="80" name="plaintext" type="text"></td>
</tr>

<tr>
<td>Ciphertext in hex:</td>
<td colspan="2"><input size="80" name="ciphertext" readonly="readonly" type="text"></td>
</tr>

<tr>
<td>&nbsp;</td>
<td>
<input value="Encrypt" onclick="RSAdoEncryption()" type="button"> 
</td><td align="right">This took <input size="4" name="howLong"> seconds</td>
</tr>
</tbody></table>
</form>

<hr width="99%" align="center">
<table width="100%"><tbody><tr>
<td>
<font size="-1"><i>www.hanewin.de</i></font>
</td>
<td align="right"><font size="-1"><i>
<a href="http://www.hanewin.de/homee.htm" target="_top">Home</a>
</i></font></td>
</tr></tbody></table>

</body></html>
