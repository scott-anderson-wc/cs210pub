#!/bin/bash

if [ $# -eq 0 ]; then
    echo "Usage: $0 [-force] yes"
    exit
fi

if [ $1 = '-force' ]; then
    force='-force'
    shift
else
    force=''
fi

if [ $1 != 'yes' ]; then
    exit
fi

if [ ! -x "bin/makepage.py" ]; then
    # in wrong directory. Try to find the right one
    if [ -d /home/cs210/cs210pub/ ]; then
        cd /home/cs210/cs210pub/
    else
        echo "Can't find the bin/makepage.py script"
        echo "Please run this script in the top git directory"
        echo "That's the same directory as the .git dir and the .gitignore file"
        exit
    fi
fi

# files are sometimes saved as anderson; change them to be owned by cs210
yes | find . -type f -user anderson -exec claim {} \;

bin/makepage.py $force index.md 
bin/makepage.py $force about.md 
bin/makepage.py $force syllabus.md 
bin/makepage.py $force reference.md 
bin/makepage.py $force reading/*.md reading/*.part
bin/makepage.py $force lectures/*/*.md 
bin/makepage.py $force assignments/*/*.md
bin/makepage.py $force quizzes/*.md
# special for the combined reading. Need to put these in the correct order
cd reading
cat cloud9.md ch02.md ch03.md ch04.md > all.md
cd ..
bin/makepage.py $force reading/all.md

# So damn tired of permission issues

opendir js
opendir css
opendir schedule
opendir reading
opendir lectures
opendir assignments
opendir images
opendir downloads
opendir quizzes
