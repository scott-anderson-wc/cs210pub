#!/bin/bash

if [ $# -eq 0 ]; then
    echo "Usage: $0 [-force] yes"
    exit
fi

if [ $1 = '-force' ]; then
    force='-force'
    shift
else
    force=''
fi

if [ $1 != 'yes' ]; then
    exit
fi

if [ ! -x "bin/makepage.py" ]; then
    # in wrong directory. Try to find the right one
    if [ -d /home/cs210/cs210pub/ ]; then
        cd /home/cs210/cs210pub/
    else
        echo "Can't find the bin/makepage.py script"
        echo "Please run this script in the top git directory"
        echo "That's the same directory as the .git dir and the .gitignore file"
        exit
    fi
fi

bin/makepage.py $force index.md 
bin/makepage.py $force reading/*.md reading/*.part
bin/makepage.py $force lectures/*/*.md 
bin/makepage.py $force assignments/*/*.md
# special for the combined reading. Need to put these in the correct order
cd reading
cat cloud9.md HTML.part URLs.part CSS1.part fonts.part accessibility.md > all.md
cd ..
bin/makepage.py $force reading/all.md
opendir reading
opendir lectures
opendir assignments
